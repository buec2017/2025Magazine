/* turn.js r3 | turnjs.com/license.txt */
(function(h){var x,y="",G=Math.PI,E=G/2,q="Touch"in window,I=q?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},J={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},O=["single","double"],P={page:1,gradients:!0,duration:600,acceleration:!0,display:"double",when:null},Q={folding:null,corners:"forward",cornerSize:100,gradients:!0,duration:600,acceleration:!0},K={"0":{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",
bottom:"auto"}},l=function(a,b,c,d){return{css:{position:"absolute",top:a,left:b,overflow:d||"hidden","z-index":c||"auto"}}},L=function(a,b,c,d,e){var f=1-e,C=f*f*f,i=e*e*e;return j(Math.round(C*a.x+3*e*f*f*b.x+3*e*e*f*c.x+i*d.x),Math.round(C*a.y+3*e*f*f*b.y+3*e*e*f*c.y+i*d.y))},j=function(a,b){return{x:a,y:b}},s=function(a,b,c){return x&&c?" translate3d("+a+"px,"+b+"px, 0px) ":" translate("+a+"px, "+b+"px) "},t=function(a){return" rotate("+a+"deg) "},p=function(a,b){return Object.prototype.hasOwnProperty.call(b,
a)},R=function(){for(var a=["Moz","Webkit","Khtml","O","ms"],b=a.length,c="";b--;)a[b]+"Transform"in document.body.style&&(c="-"+a[b].toLowerCase()+"-");return c},M=function(a,b,c,d,e){var f,C=[];if("-webkit-"==y){for(f=0;f<e;f++)C.push("color-stop("+d[f][0]+", "+d[f][1]+")");a.css({"background-image":"-webkit-gradient(linear, "+b.x+"% "+b.y+"%,  "+c.x+"% "+c.y+"%, "+C.join(",")+" )"})}else{var b={x:b.x/100*a.width(),y:b.y/100*a.height()},c={x:c.x/100*a.width(),y:c.y/100*a.height()},i=c.x-b.x;f=c.y-
b.y;var h=Math.atan2(f,i),g=h-Math.PI/2,g=Math.abs(a.width()*Math.sin(g))+Math.abs(a.height()*Math.cos(g)),i=Math.sqrt(f*f+i*i),c=j(c.x<b.x?a.width():0,c.y<b.y?a.height():0),n=Math.tan(h);f=-1/n;n=(f*c.x-c.y-n*b.x+b.y)/(f-n);c=f*n-f*c.x+c.y;b=Math.sqrt(Math.pow(n-b.x,2)+Math.pow(c-b.y,2));for(f=0;f<e;f++)C.push(" "+d[f][1]+" "+100*(b+i*d[f][0])/g+"%");a.css({"background-image":y+"linear-gradient("+-h+"rad,"+C.join(",")+")"})}},g={init:function(a){void 0===x&&(x="WebKitCSSMatrix"in window||"MozPerspective"in
document.body.style,y=R());var b,c=this.data(),d=this.children(),a=h.extend({width:this.width(),height:this.height()},P,a);c.opts=a;c.pageObjs={};c.pages={};c.pageWrap={};c.pagePlace={};c.pageMv=[];c.totalPages=a.pages||0;if(a.when)for(b in a.when)p(b,a.when)&&this.bind(b,a.when[b]);this.css({position:"relative",width:a.width,height:a.height});this.turn("display",a.display);x&&!q&&a.acceleration&&this.transform(s(0,0,!0));for(b=0;b<d.length;b++)this.turn("addPage",d[b],b+1);this.turn("page",a.page);
J=h.extend({},J,a.corners);h(this).bind(I.start,function(a){for(var b in c.pages)if(p(b,c.pages)&&i._eventStart.call(c.pages[b],a)===false)return false});h(document).bind(I.move,function(a){for(var b in c.pages)p(b,c.pages)&&i._eventMove.call(c.pages[b],a)}).bind(I.end,function(a){for(var b in c.pages)p(b,c.pages)&&i._eventEnd.call(c.pages[b],a)});c.done=!0;return this},addPage:function(a,b){var c=!1,d=this.data(),e=d.totalPages+1;if(b)if(b==e)b=e,c=!0;else{if(b>e)throw Error('It is impossible to add the page "'+
b+'", the maximum value is: "'+e+'"');}else b=e,c=!0;1<=b&&b<=e&&(d.done&&this.turn("stop"),b in d.pageObjs&&g._movePages.call(this,b,1),c&&(d.totalPages=e),d.pageObjs[b]=h(a).addClass("turn-page p"+b),g._addPage.call(this,b),d.done&&this.turn("update"),g._removeFromDOM.call(this));return this},_addPage:function(a){var b=this.data(),c=b.pageObjs[a];if(c)if(g._necessPage.call(this,a)){if(!b.pageWrap[a]){var d="double"==b.display?this.width()/2:this.width(),e=this.height();c.css({width:d,height:e});
b.pagePlace[a]=a;b.pageWrap[a]=h("<div/>",{"class":"turn-page-wrapper",page:a,css:{position:"absolute",overflow:"hidden",width:d,height:e}}).css(K["double"==b.display?a%2:0]);this.append(b.pageWrap[a]);b.pageWrap[a].prepend(b.pageObjs[a])}(!a||1==g._setPageLoc.call(this,a))&&g._makeFlip.call(this,a)}else b.pagePlace[a]=0,b.pageObjs[a]&&b.pageObjs[a].remove()},hasPage:function(a){return a in this.data().pageObjs},_makeFlip:function(a){var b=this.data();if(!b.pages[a]&&b.pagePlace[a]==a){var c="single"==
b.display,d=a%2;b.pages[a]=b.pageObjs[a].css({width:c?this.width():this.width()/2,height:this.height()}).flip({page:a,next:c&&a===b.totalPages?a-1:d||c?a+1:a-1,turn:this,duration:b.opts.duration,acceleration:b.opts.acceleration,corners:c?"all":d?"forward":"backward",backGradient:b.opts.gradients,frontGradient:b.opts.gradients}).flip("disable",b.disabled).bind("pressed",g._pressed).bind("released",g._released).bind("start",g._start).bind("end",g._end).bind("flip",g._flip)}return b.pages[a]},_makeRange:function(){var a;
this.data();var b=this.turn("range");for(a=b[0];a<=b[1];a++)g._addPage.call(this,a)},range:function(a){var b,c,d=this.data(),a=a||d.tpage||d.page,e=g._view.call(this,a);if(1>a||a>d.totalPages)throw Error('"'+a+'" is not a page for range');e[1]=e[1]||e[0];1<=e[0]&&e[1]<=d.totalPages?(a=Math.floor(2),d.totalPages-e[1]>e[0]?(b=Math.min(e[0]-1,a),c=2*a-b):(c=Math.min(d.totalPages-e[1],a),b=2*a-c)):c=b=5;return[Math.max(1,e[0]-b),Math.min(d.totalPages,e[1]+c)]},_necessPage:function(a){if(0===a)return!0;
var b=this.turn("range");return a>=b[0]&&a<=b[1]},_removeFromDOM:function(){var a,b=this.data();for(a in b.pageWrap)p(a,b.pageWrap)&&!g._necessPage.call(this,a)&&g._removePageFromDOM.call(this,a)},_removePageFromDOM:function(a){var b=this.data();if(b.pages[a]){var c=b.pages[a].data();c.f&&c.f.fwrapper&&c.f.fwrapper.remove();b.pages[a].remove();delete b.pages[a]}b.pageObjs[a]&&b.pageObjs[a].remove();b.pageWrap[a]&&(b.pageWrap[a].remove(),delete b.pageWrap[a]);delete b.pagePlace[a]},removePage:function(a){var b=
this.data();b.pageObjs[a]&&(this.turn("stop"),g._removePageFromDOM.call(this,a),delete b.pageObjs[a],g._movePages.call(this,a,-1),b.totalPages-=1,g._makeRange.call(this),b.page>b.totalPages&&this.turn("page",b.totalPages));return this},_movePages:function(a,b){var c,d=this.data(),e="single"==d.display,f=function(a){var c=a+b,f=c%2;d.pageObjs[a]&&(d.pageObjs[c]=d.pageObjs[a].removeClass("page"+a).addClass("page"+c));d.pagePlace[a]&&d.pageWrap[a]&&(d.pagePlace[c]=c,d.pageWrap[c]=d.pageWrap[a].css(K[e?
0:f]).attr("page",c),d.pages[a]&&(d.pages[c]=d.pages[a].flip("options",{page:c,next:e||f?c+1:c-1,corners:e?"all":f?"forward":"backward"})),b&&(delete d.pages[a],delete d.pagePlace[a],delete d.pageObjs[a],delete d.pageWrap[a],delete d.pageObjs[a]))};if(0<b)for(c=d.totalPages;c>=a;c--)f(c);else for(c=a;c<=d.totalPages;c++)f(c)},display:function(a){var b=this.data(),c=b.display;if(a){if(-1==h.inArray(a,O))throw Error('"'+a+'" is not a value for display');"single"==a?b.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),
b.pageObjs[0]=h("<div />",{"class":"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)):b.pageObjs[0]&&(this.turn("stop").css({overflow:""}),b.pageObjs[0].remove(),delete b.pageObjs[0]);b.display=a;c&&(a=this.turn("size"),g._movePages.call(this,1,0),this.turn("size",a.width,a.height).turn("update"));return this}return c},animating:function(){return 0<this.data().pageMv.length},disable:function(a){var b,c=this.data(),d=this.turn("view");c.disabled=void 0===a||!0===
a;for(b in c.pages)p(b,c.pages)&&c.pages[b].flip("disable",a?h.inArray(b,d):!1);return this},size:function(a,b){if(a&&b){var c=this.data(),d="double"==c.display?a/2:a,e;this.css({width:a,height:b});c.pageObjs[0]&&c.pageObjs[0].css({width:d,height:b});for(e in c.pageWrap)p(e,c.pageWrap)&&(c.pageObjs[e].css({width:d,height:b}),c.pageWrap[e].css({width:d,height:b}),c.pages[e]&&c.pages[e].css({width:d,height:b}));this.turn("resize");return this}return{width:this.width(),height:this.height()}},resize:function(){var a,
b=this.data();b.pages[0]&&(b.pageWrap[0].css({left:-this.width()}),b.pages[0].flip("resize",!0));for(a=1;a<=b.totalPages;a++)b.pages[a]&&b.pages[a].flip("resize",!0)},_removeMv:function(a){var b,c=this.data();for(b=0;b<c.pageMv.length;b++)if(c.pageMv[b]==a)return c.pageMv.splice(b,1),!0;return!1},_addMv:function(a){var b=this.data();g._removeMv.call(this,a);b.pageMv.push(a);c.pagePlace[a]=a;b.pagePlace[a]=a;b.pageMv.push(a)},update:function(){var a,b=this.data();if(b.pageMv.length&&0!==b.pageMv[0]){var c=this.turn("calculateZ",b.pageMv);this.turn("view",b.tpage);for(a in b.pageWrap)p(a,b.pageWrap)&&(b.pageWrap[a].css({display:c.pageV[a]?"":"none","z-index":c.pageZ[a]||0}),b.pages[a]&&(b.pages[a].flip("z",c.partZ[a]||null),c.pageV[a]&&b.pages[a].flip("resize"),b.tpage&&b.pages[a].flip("disable",!0)))}else for(a in b.pageWrap)p(a,b.pageWrap)&&(c=g._setPageLoc.call(this,a),b.pages[a]&&b.pages[a].flip("disable",b.disabled||1!=c).flip("z",null))},_setPageLoc:function(a){var b=this.data(),c=this.turn("view");if(a==c[0]||a==c[1])return b.pageWrap[a].css({"z-index":b.totalPages,display:""}),1;if("single"==b.display&&a==c[0]-1)return b.pageWrap[a].css({"z-index":b.totalPages-1,display:""}),2;if("single"==b.display&&a==c[1]+1)return b.pageWrap[a].css({"z-index":b.totalPages-1,display:""}),3;b.pageWrap[a].css({display:"none"});return 0},calculateZ:function(a){var b=this.data(),c={},d={},e={},f,g,h,k={},n=!1,m=!1,p=!1;f=a.length;var r=this.turn("view"),u=this.turn("display");for(g=0;g<f;g++){h=a[g];var w=b.pages[h].data();k[h]=w;w.f=void 0}for(g=0;g<f;g++)if(h=a[g],w=b.pages[h].data(),w.f)if(w.f.fwrapper){var v=w.f.fwrapper;v&&v.css({display:"block"}),n=!0}else m=!0;else p=!0;if(n&&!m)return{pageV:c,pageZ:d,partZ:e};var t=!1;f=a.length;for(g=0;g<f;g++)if(h=a[g],w=b.pages[h].data(),w.f&&!w.f.fwrapper){c[h]=!0;d[h]=b.totalPages-g;e[h]=
w.f.options.flip&&(w.f.options.flip=="forward"?1:2)}else c[h]=!1;return{pageV:c,pageZ:d,partZ:e}},view:function(a){var b=this.data(),c=[],d;void 0===a&&(a=b.page);d="single"==b.display?[a]:[a%2?Math.max(a-1,1):a,a%2?Math.min(a+1,b.totalPages):a];return d},stop:function(){var a=this.data();a.pageMv=[];return this},pages:function(){return this.data().totalPages}}};h.fn.turn=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,1));if(typeof a==="object"||!a)return g.init.apply(this,arguments);throw Error("Method "+a+" does not exist on jQuery.turn")}
;h.fn.turn.defaults=P})(jQuery);
